<?php

namespace App\Console\Commands;

use App\Exports\AveragePriceBySoldBetweenDatesExport;
use Illuminate\Console\Command;
use Maatwebsite\Excel\Facades\Excel;

class AveragePriceBySoldBetweenDatesExportCommand extends Command
{
    /**
     * The name and signature of the console command.
     *
     * @var string
     */
    protected $signature = 'statistics:get-avg-price-of-zero-values';

    /**
     * The console command description.
     *
     * @var string
     */
    protected $description = 'Get zero based avg price based on isbns';

    /**
     * Create a new command instance.
     *
     * @return void
     */
    public function __construct()
    {
        parent::__construct();
    }

    /**
     * Execute the console command.
     *
     * @return int
     */
    public function handle()
    {
        $isbns = [
            '9786155596834',
            '9786155252990',
            '9786155596605',
            '9786155692734',
            '9789635700295',
            '9786156145680',
            '9789635701360',
            '9789635701896',
            '9789635702473',
            '9789635702114',
            '9789635702916',
            '9789635702558',
            '9789635703012',
            '9789635702992',
            '9786156145703',
            '9789635702299',
            '9789635703173',
            '9789635703319',
            '9789635703425',
            '9789635701575',
            '9789635703524',
            '9789635703555',
            '9789635700875',
            '9789635703500',
            '9789635703616',
            '9789635703630',
            '9789635703838',
            '9789635704347',
            '9789635704361',
            '9789635704422',
            '9789635704408',
            '9789635704545',
            '9789635704767',
            '9789635704781',
            '9786155596155',
            '9786155692017',
            '9786155596131',
            '9786155763274',
            '9786155692260',
            '9786155929250',
            '9786156145543',
            '9786156145161',
            '9786156145185',
            '9789635700417',
            '9789635700615',
            '9789635701414',
            '9789635701698',
            '9789635702152',
            '9789635702411',
            '9789635702237',
            '9789635702398',
            '9789635700479',
            '9789635703050',
            '9789635701537',
            '9789635701438',
            '9789635703258',
            '9789635703357',
            '9789635702732',
            '9789635703333',
            '9789635703135',
            '9789635703098',
            '9789635703111',
            '9789635703296',
            '9789635703784',
            '9789635703814',
            '9789635701322',
            '9789635702954',
            '9789635702978',
            '9789635703852',
            '9789635704019',
            '9789635704156',
            '9789635704279',
            '9789635703937',
            '9789635704095',
            '9789635704057',
            '9789635704071',
            '9789635704293',
            '9789635704385',
            '9789635705047',
            '9789635704620',
            '9789635705368',
            '9789635705528',
            '9789635705320',
            '9786155596179',
            '9789635702213',
            '9786156145697',
            '9789635703036',
            '9789635703074',
            '9789635703197',
            '9789635703579',
            '9789635704132',
            '9789635704118',
            '9789635703371',
            '9786155596193',
            '9786155763656',
            '9786155875069',
            '9786155596285',
            '9786155692284',
            '9786155875779',
            '9786155763694',
            '9786156067807',
            '9786156145062',
            '9786150117928',
            '9789635702794',
            '9789635702077',
            '9789635703210',
            '9789635703272',
            '9789635702817',
            '9789635703401',
            '9789635703487',
            '9789635703593',
            '9789635703913',
            '9789635704460',
            '9789635704033',
            '9789635700752',
            '9789635701186',
            '9789635702015',
            '9789635703449',
            '9789635704521',
            '9789635704682',
            '9789635704170',
            '9789635704705',
            '9789635704217',
            '9789635700714',
        ];

        $startDate = '2022-10-01 00:00:00';
        $endDate = '2022-10-31 23:59:59';
        $fileName = 'statistic/1001-1031-arak.xlsx';

        return Excel::store(new AveragePriceBySoldBetweenDatesExport($isbns, $startDate, $endDate), $fileName, 'local');
    }
}
